<!DOCTYPE html>
<html xmlns='http://www.w3.org/1999/xhtml' lang='en'>
<head>
  <meta charset="utf-8">
  <title>(Ëµ Í¡Â° ÍœÊ– Í¡Â°Ëµ)</title>
  <link rel="icon" href="assets/favicon.ico">
  <link rel="stylesheet" href="style.css">
  <style>
    #canvasContainer { margin-top: 1rem; text-align: center; }
    canvas { border: 1px solid #000; background: #fff; display: block; margin: 0 auto; }
    button { margin-top: 0.5rem; padding: 8px 14px; cursor: pointer; border-radius: 6px; background: #000; color: #fff; border: none; }
    button:hover { background: #444; }
    #gallery { margin-top:1rem; display:grid; grid-template-columns:repeat(auto-fill,150px); gap:10px; justify-content:center; }
    #gallery img { max-width:150px; border:1px solid #ccc; }
  </style>
</head>
<body>
  <div id="content">
    <div class="container">
      <div class="text" style="text-align:center;">
        <a href='index' id="home-link">*</a><br>
        what's on your mind? (ðŸ–Œdouble click to start againðŸ–Œ)
      </div>
    </div>
  </div>

  <div id="canvasContainer">
    <canvas id="drawCanvas" width="500" height="500"></canvas>
    <button id="sendBtn">enviar dibujo ðŸŽ¨</button>
    <div id="gallery"></div>
  </div>

  <!-- EmailJS SDK -->
  <script src="https://cdn.emailjs.com/dist/email.min.js"></script>

  <script>
    // Inicializar EmailJS
    (function() {
      emailjs.init("l06doB2wxnGk4vSmz"); // Public Key
    })();

    const canvas = document.getElementById('drawCanvas');
    const ctx = canvas.getContext('2d');
    const btn = document.getElementById('sendBtn');
    let drawing = false;

    // Dibujo simple
    canvas.addEventListener('mousedown', () => drawing = true);
    canvas.addEventListener('mouseup', () => drawing = false);
    canvas.addEventListener('mouseout', () => drawing = false);
    canvas.addEventListener('mousemove', e => {
      if (!drawing) return;
      const rect = canvas.getBoundingClientRect();
      ctx.beginPath();
      ctx.arc(e.clientX - rect.left, e.clientY - rect.top, 2, 0, Math.PI * 2);
      ctx.fillStyle = "#000";
      ctx.fill();
    });
    canvas.addEventListener('dblclick', () => ctx.clearRect(0, 0, canvas.width, canvas.height));

    // Enviar dibujo por EmailJS
    btn.addEventListener('click', async () => {
      const dataURL = canvas.toDataURL("image/png");

      const params = {
        to_email: "casfemarta@gmail.com",
        message: "Nuevo dibujo recibido ðŸŽ¨",
        attachment: dataURL
      };

      btn.disabled = true;
      btn.textContent = "enviando...";

      try {
        await emailjs.send("service_o3jmvle", "template_r72a0hl", params);
        alert("Â¡Dibujo enviado a Marta!");
      } catch (err) {
        console.error("Error al enviar:", err);
        alert("Error al enviar el dibujo ðŸ˜¢");
      } finally {
        btn.disabled = false;
        btn.textContent = "enviar dibujo ðŸŽ¨";
      }
    });
  </script>
</body>
</html>
